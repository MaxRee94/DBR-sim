import statistics as stats

data = """
0.01	0.482445747	257512
0.011428571	0.484303385	273555
0.012857143	0.485010862	285989
0.014285714	0.488074005	292516
0.015714286	0.484037548	297288
0.017142857	0.483653426	295904
0.018571429	0.482707262	291727
0.02	0.482907981	303820
0.02	0.486148	301602
0.02125	0.486590713	302862
0.0225	0.487493485	310281
0.02375	0.482324213	307313
0.025	0.488535166	311545
0.02625	0.482701808	310465
0.0275	0.487293839	308370
0.02875	0.484002829	313972
0.03	0.48417753	311215
0.03125	0.488994151	313204
0.03375	0.486943364	317503
0.035	0.486552745	320474
0.03625	0.488069654	318429
0.0375	0.482843965	320378
0.03875	0.48432076	323514
0.04	0.484720051	323601
0.04125	0.488041461	323237
0.04375	0.484033197	326019
0.045	0.485061854	327417
0.04625	0.482893884	325489
0.0475	0.483270407	325344
0.04875	0.483805329	329490
0.05	0.482824445	326908
0.05125	0.488129348	328527
0.05375	0.48355794	329637
0.055	0.48298502	331208
0.05625	0.484016925	329939
0.0575	0.485823572	329040
0.05875	0.489210069	330257
0.06	0.485287547	329900
0.06125	0.487623692	331191
0.06375	0.487679034	332471
0.065	0.48907119	333756
0.06625	0.488057733	332948
0.0675	0.483796656	331331
0.06875	0.489680976	332040
0.07	0.489125431	331182
0.07125	0.490058601	333209
0.07375	0.490281045	334565
0.075	0.489457458	334401
0.07625	0.487354606	335439
0.0775	0.487800568	333800
0.07875	0.48474285	335729
0.08	0.484586596	336158
0.08125	0.483489573	335771
0.08375	0.488706589	335156
0.085	0.484076619	337268
0.08625	0.48725152	335983
0.0875	0.486571193	337691
0.08875	0.485011935	338705
0.09	0.483423382	336851
0.09125	0.486555994	338760
0.09375	0.485023886	337344
0.095	0.485098749	339140
0.09625	0.487077922	340095
0.0975	0.486605912	338357
0.09875	0.48408854	340100
0.1	0.494649529	339030
0.10125	0.485154092	341091
0.10375	0.487051874	340024
0.105	0.486172974	339549
0.10625	0.487590075	338999
0.1075	0.485107422	339873
0.10875	0.488780379	338389
0.11	0.489636511	338813
0.11125	0.484317482	340003
0.11375	0.483964831	341385
0.115	0.48515299	341891
0.11625	0.487787545	339814
0.1175	0.487621516	341023
0.11875	0.489358723	339898
0.12	0.485566407	340179
0.12125	0.485503465	339148
0.12375	0.487597644	341686
0.125	0.499356568	337726
0.12625	0.488642573	339788
0.1275	0.489976138	339974
0.12875	0.489379346	342651
0.13	0.485401481	342167
0.13125	0.487979591	341099
0.13375	0.485506713	340747
0.135	0.489240438	341956
0.13625	0.48858723	339908
0.1375	0.488961577	340481
0.13875	0.489435762	341123
0.14	0.489741743	342032
0.14125	0.484529078	342666
0.14375	0.486012369	342357
0.145	0.485782325	343922
0.14625	0.486756742	342144
0.1475	0.484807938	340758
0.14875	0.489482433	342847
0.15	0.488067478	342047
0.15125	0.485403657	342571
0.15375	0.487148434	344029
0.155	0.489605039	342599
0.15625	0.488692492	342677
0.1575	0.490481764	342293
0.15875	0.490435123	342613
0.16	0.490218103	341475
0.16125	0.485515416	342017
0.16375	0.488767356	340393
0.165	0.489800334	342217
0.16625	0.487192929	343424
0.1675	0.486437708	341966
0.16875	0.485017359	341587
0.17	0.490732431	341268
0.17125	0.485067278	342511
0.17375	0.487710506	341599
0.175	0.489633232	343905
0.17625	0.485906035	342844
0.1775	0.485291898	344336
0.17875	0.485017359	343367
0.18	0.489391267	341457
0.18125	0.484716803	344007
0.18375	0.488843322	342821
0.185	0.486557066	344973
0.18625	0.489952266	341853
0.1875	0.491932511	342806
0.18875	0.491606981	341808
0.19	0.488985449	343867
0.19125	0.485831171	343544
0.19375	0.487657338	342485
0.195	0.490359157	344590
0.19625	0.489490032	344252
0.1975	0.487616092	342881
0.19875	0.48650825	343546
0.2	0.508768439	339252
0.20125	0.492457688	342893
0.20375	0.488643676	341433
0.205	0.490160584	344637
0.20625	0.488297522	345218
0.2075	0.488944232	344113
0.20875	0.488590509	343845
0.21	0.488654524	342401
0.21125	0.491120875	343070
0.21375	0.488006741	345893
0.215	0.490541458	341907
0.21625	0.487954646	341741
0.2175	0.490937501	341917
0.21875	0.488671869	342337
0.22	0.488590509	342978
0.22125	0.49087131	342317
0.22375	0.488760859	341375
0.225	0.489887148	344620
0.22625	0.490494788	342856
0.2275	0.487075746	342583
0.22875	0.491558164	343184
0.23	0.488243282	343099
0.23125	0.486034065	343168
0.23375	0.491609156	342346
0.235	0.48922959	343579
0.23625	0.489023447	341660
0.2375	0.488815099	342145
0.23875	0.487680107	341441
0.24	0.490686864	343862
0.24125	0.490301639	341160
0.24375	0.487990439	344699
0.245	0.489134103	341555
0.24625	0.487048626	341679
0.2475	0.486899942	344171
0.24875	0.486773014	344197
0.25	0.521105707	337508
0.25125	0.485968977	341951
0.25375	0.48890081	342917
0.255	0.492431641	342150
0.25625	0.487615019	343741
0.2575	0.492354602	343151
0.25875	0.489436835	342877
0.26	0.491748035	343171
0.26125	0.491345495	342089
0.26375	0.489667982	343037
0.265	0.491009116	345289
0.26625	0.489412963	345972
0.2675	0.488438576	343422
0.26875	0.490092218	342699
0.27	0.488820523	342986
0.27125	0.488140196	343337
0.27375	0.487253696	341728
0.275	0.48847872	344475
0.27625	0.489725471	342381
0.2775	0.486844629	343827
0.27875	0.486499578	341811
0.28	0.491513669	343816
0.28125	0.491903216	342526
0.28375	0.487588972	343410
0.285	0.489882827	343169
0.28625	0.488429904	343029
0.2875	0.486321628	342588
0.28875	0.489102662	342661
0.29	0.489480257	341728
0.29125	0.488980025	344527
0.29375	0.48765409	343450
0.295	0.491202265	344046
0.29625	0.489541024	342122
0.2975	0.489168823	341671
0.29875	0.4884592	344612
0.3	0.495396048	342621
0.30125	0.492666006	342542
0.30375	0.488637149	341967
0.305	0.490023881	343209
0.30625	0.486970484	342961
0.3075	0.489172101	344032
0.30875	0.489189446	343431
0.31	0.489213318	343039
0.31125	0.491307497	343864
0.31375	0.490252823	342188
0.315	0.49096787	343065
0.31625	0.487954646	342983
0.3175	0.487718105	343476
0.31875	0.488955081	342972
0.32	0.490964621	342064
0.32125	0.487569451	342568
0.32375	0.4889898	341599
0.325	0.487003028	340984
0.32625	0.489666879	342585
0.3275	0.489560544	344049
0.32875	0.48823458	344671
0.33	0.492134333	340294
0.33125	0.491302073	343663
0.33375	0.489768893	342984
0.335	0.487617195	341659
0.33625	0.487623692	344620
0.3375	0.487161458	345236
0.33875	0.488706589	340700
0.34125	0.491572261	341672
0.34375	0.491264105	341314
0.345	0.491238058	343386
0.34625	0.490036905	343633
0.3475	0.487484813	342672
0.34875	0.489721149	343087
0.35125	0.489838332	342663
0.35375	0.488869369	343133
0.355	0.491225034	342963
0.35625	0.493243277	342921
0.3575	0.489116758	343297
0.35875	0.491809905	342226
0.36125	0.491274953	340860
0.36375	0.490682513	342531
0.365	0.492642134	342028
0.36625	0.490069449	343469
0.3675	0.48833549	342990
0.36875	0.489600688	341606
0.37125	0.492596567	342647
0.37375	0.492389321	341288
0.375	0.497469604	341858
0.37625	0.491315097	343449
0.3775	0.489267588	343070
0.37875	0.490131289	343031
0.38125	0.492677957	342967
0.38375	0.492101789	342632
0.385	0.490670562	341305
0.38625	0.491247833	340850
0.3875	0.488967001	341845
0.38875	0.490405828	341434
0.39125	0.491046011	340646
0.39375	0.492034495	337832
0.395	0.491468102	341468
0.39625	0.489457458	341517
0.3975	0.49084419	342798
0.39875	0.491285801	341653
0.40125	0.49053818	341808
0.40375	0.492247164	342279
0.405	0.487748474	342542
0.40625	0.492182076	341960
0.4075	0.487871081	341427
0.40875	0.489169925	340101
0.41125	0.486459404	344047
0.41375	0.490713984	341087
0.415	0.491280377	341616
0.41625	0.489453137	341158
0.4175	0.49123916	343246
0.41875	0.490366757	343021
0.42125	0.491317272	340508
0.42375	0.486235887	342352
0.425	0.492635638	340564
0.42625	0.489571393	342330
0.4275	0.49081707	342351
0.42875	0.490791023	342249
0.43125	0.490238726	342555
0.43375	0.48964411	340342
0.435	0.489963114	343091
0.43625	0.492686629	340975
0.4375	0.491522342	341363
0.43875	0.490919054	341969
0.44125	0.490315765	340822
0.44375	0.49167642	340975
0.445	0.487728953	340439
0.44625	0.491911888	340489
0.4475	0.489937067	342999
0.44875	0.490657538	341052
0.45125	0.490413398	340516
0.45375	0.48961696	340389
0.455	0.491922736	341198
0.45625	0.489715725	341763
0.4575	0.49118489	340807
0.45875	0.487341583	342400
0.46125	0.490876734	342569
0.46375	0.489866525	341873
0.465	0.490754128	342761
0.46625	0.48981446	342373
0.4675	0.490199655	341510
0.46875	0.49109593	340915
0.47125	0.492144108	341613
0.47375	0.491958559	341134
0.475	0.491222858	343217
0.47625	0.490474164	341045
0.4775	0.491465926	341513
0.47875	0.48962456	342352
0.48125	0.490946174	341187
0.48375	0.491977006	341475
0.485	0.490509987	341417
0.48625	0.488910586	341885
0.4875	0.489925116	340977
0.48875	0.492850482	341785
0.49125	0.491172969	338789
0.49375	0.492184252	341608
0.495	0.492877603	340872
0.49625	0.489356548	341913
0.4975	0.490338534	340982
0.49875	0.489576817	342979
0.50125	0.492775619	341428
0.50375	0.49079752	340707
0.505	0.491342217	340087
0.50625	0.491546214	341010
0.5075	0.489217669	340431
0.50875	0.492291659	339978
0.51125	0.492556423	339402
0.51375	0.48750326	340778
0.515	0.489186198	340536
0.51625	0.493171662	341085
0.5175	0.487119138	340733
0.51875	0.491842449	340602
0.52125	0.49296549	340343
0.52375	0.488720715	341634
0.525	0.491847873	339378
0.52625	0.487993717	339753
0.5275	0.489484578	340833
0.52875	0.48739475	341623
0.53125	0.491945535	340069
0.53375	0.488230258	340518
0.535	0.492006302	341833
0.53625	0.491674274	342017
0.5375	0.490084648	341243
0.53875	0.493121743	341213
0.54125	0.493752182	340515
0.54375	0.491132826	338066
0.545	0.493028432	339853
0.54625	0.490973294	339947
0.5475	0.488957256	341739
0.54875	0.491892368	340649
0.55125	0.489484578	340025
0.55375	0.492697477	339492
0.555	0.489897996	339801
0.55625	0.490832239	339413
0.5575	0.493197709	340104
0.55875	0.492109388	342301
0.56125	0.488054484	340970
0.56375	0.491892368	339335
0.565	0.490334213	339923
0.56625	0.489458561	340256
0.5675	0.488942057	341791
0.56875	0.489664704	342251
0.57125	0.49259007	341237
0.57375	0.49159506	340446
0.575	0.491778433	340377
0.57625	0.491515845	340638
0.5775	0.491917312	339431
0.57875	0.490246296	339666
0.58125	0.492721349	341019
0.58375	0.4918468	338434
0.585	0.488440752	340314
0.58625	0.489796013	338891
0.5875	0.490353733	340799
0.58875	0.489450961	340510
0.59125	0.492243916	340959
0.59375	0.490977645	340250
0.595	0.491255432	340524
0.59625	0.489906698	339656
0.5975	0.490438372	340467
0.59875	0.491012365	339537
0.60125	0.491598308	341807
0.60375	0.490579426	338822
0.605	0.492105037	341166
0.60625	0.490152985	340085
0.6075	0.492862403	338553
0.60875	0.493233502	339477
0.61125	0.491332471	342291
0.61375	0.493493915	338420
0.615	0.490571827	341364
0.61625	0.49137044	340204
0.6175	0.491376966	341033
0.61875	0.492173404	339083
0.62125	0.491100252	341784
0.62375	0.487119138	339888
0.625	0.49615559	340129
0.62625	0.49025175	338877
0.6275	0.491108954	342234
0.62875	0.49039498	339131
0.63125	0.491843522	339767
0.63375	0.490131289	338419
0.635	0.491687298	341107
0.63625	0.488278002	339764
0.6375	0.491021037	340746
0.63875	0.490974396	339633
0.64125	0.490287542	341283
0.64375	0.491781682	340425
0.645	0.49121201	340039
0.64625	0.490656465	341449
0.6475	0.491108954	339347
0.64875	0.491013467	341862
0.65125	0.487342656	339759
0.65375	0.489155829	339836
0.655	0.493102223	338160
0.65625	0.492912322	339893
0.6575	0.492126733	339636
0.65875	0.488117397	340682
0.66125	0.491407335	338738
0.66375	0.489879549	338852
0.665	0.491343319	338625
0.66625	0.489887148	339024
0.6675	0.488298625	339507
0.66875	0.490176857	341649
0.67125	0.491172969	342457
0.67375	0.490732431	340280
0.675	0.492751747	337967
0.67625	0.488065332	340814
0.6775	0.487513036	338787
0.67875	0.491429031	342213
0.68125	0.489749342	341269
0.68375	0.491685122	338488
0.685	0.492190748	340514
0.68625	0.492300361	339990
0.6875	0.49055773	340069
0.68875	0.491977006	338225
0.69125	0.494514972	339515
0.69375	0.488025188	339769
0.695	0.493326813	339788
0.69625	0.490390629	341160
0.6975	0.489973962	340122
0.69875	0.48882705	342862
0.70125	0.490248471	341952
0.70375	0.491243482	341505
0.705	0.49312067	339570
0.70625	0.490560979	339560
0.7075	0.490464419	340774
0.70875	0.491066635	340549
0.71125	0.489595264	340597
0.71375	0.494013667	336007
0.715	0.492539048	339785
0.71625	0.488652349	339468
0.7175	0.487995863	341471
0.71875	0.488460273	338837
0.72125	0.489037544	340007
0.72375	0.489407539	338426
0.725	0.491005868	341094
0.72625	0.492596567	339934
0.7275	0.489840508	340851
0.72875	0.491528869	342206
0.73125	0.492966592	338533
0.73375	0.490295142	340050
0.735	0.488414705	341150
0.73625	0.490571827	339721
0.7375	0.488667548	340361
0.73875	0.491550565	341805
0.74125	0.488601357	341695
0.74375	0.491318345	340727
0.745	0.488440752	341416
0.74625	0.489654958	337758
0.7475	0.489750445	340318
0.74875	0.490686864	338850
0.75125	0.491628677	340142
0.75375	0.491220713	340110
0.755	0.489746094	338491
0.75625	0.489232868	341964
0.7575	0.491241306	340259
0.75875	0.492062718	340940
0.76125	0.49293077	340119
0.76375	0.492573798	340942
0.765	0.492786467	339786
0.76625	0.488028437	338681
0.7675	0.488393009	339381
0.76875	0.489862204	339996
0.77125	0.490916878	339649
0.77375	0.49113825	337551
0.775	0.493472219	340484
0.77625	0.489157975	341826
0.7775	0.489280611	341119
0.77875	0.488007814	339772
0.78125	0.490406901	339052
0.78375	0.492280811	341726
0.785	0.49266386	339467
0.78625	0.488627374	339231
0.7875	0.489541024	339863
0.78875	0.488511294	339555
0.79125	0.491089404	340838
0.79375	0.488785803	339726
0.795	0.488411456	339616
0.79625	0.490996093	339242
0.7975	0.493512362	338131
0.79875	0.492096364	339746
0.80125	0.492167979	339260
0.80375	0.487931848	339659
0.805	0.489328355	340557
0.80625	0.491965055	339066
0.8075	0.488090277	339353
0.80875	0.489708126	338361
0.81125	0.491631955	340097
0.81375	0.489994586	341509
0.815	0.490937501	339425
0.81625	0.490590274	341298
0.8175	0.48948893	342258
0.81875	0.492737621	340077
0.82125	0.489914268	339735
0.82375	0.490412325	340894
0.825	0.490231127	339936
0.82625	0.49001193	340205
0.8275	0.490897357	341091
0.82875	0.489548624	341079
0.83125	0.494031042	338463
0.83375	0.494472653	340033
0.835	0.493156463	340536
0.83625	0.490601122	341891
0.8375	0.490971148	338275
0.83875	0.491066635	341675
0.84125	0.490364581	339677
0.84375	0.489436835	340348
0.845	0.488070756	339833
0.84625	0.49161458	341236
0.8475	0.488798827	341591
0.84875	0.49082464	340622
0.85125	0.49290365	340683
0.85375	0.48941949	338468
0.855	0.492820084	338712
0.85625	0.493295342	339036
0.8575	0.492343754	340854
0.85875	0.488909513	341796
0.86125	0.490711808	338127
0.86375	0.492305785	338554
0.865	0.48862195	340112
0.86625	0.48945421	341287
0.8675	0.490528435	339591
0.86875	0.491917312	338572
0.87125	0.491550565	339502
0.87375	0.494227439	339637
0.875	0.495435119	337983
0.87625	0.492684454	340478
0.8775	0.490857214	339423
0.87875	0.492151707	341116
0.88125	0.493568808	340738
0.88375	0.491091579	340055
0.885	0.492734373	339117
0.88625	0.487703979	339722
0.8875	0.491416007	339594
0.88875	0.492988288	341277
0.89125	0.490085721	341678
0.89375	0.490223527	339819
0.895	0.493359387	337696
0.89625	0.491090506	340682
0.8975	0.489737421	339354
0.89875	0.490228951	340937
"""

def get_bucket(buckets, value, half_step_size):
    bucket = buckets[0]
    for i in range(len(buckets)):
        if value >= (buckets[i] - half_step_size):
            if i == len(buckets) - 1:
                return buckets[i]
            if value <= (buckets[i + 1] - half_step_size):
                return buckets[i]
    else:
        raise RuntimeError("No bucket found for value " + str(value) + "(buckets:)" + str(buckets))

# --- Parameters --- #
no_steps = 45

# --- Preparation --- #
lines = [l for l in data.split("\n") if l != ""]
initial_cover_range = [float(lines[0].split("\t")[0]), float(lines[-1].split("\t")[0])]
step_size = (initial_cover_range[1] - initial_cover_range[0]) / (no_steps)
print(f"Range: ({initial_cover_range[0]}, {initial_cover_range[1]}), step size: {step_size}")
buckets = [initial_cover_range[0] + step_size * (float(i) + 0.5) for i in range(no_steps)]
print("Buckets:", buckets)
aggregated_data = {}
for i, line in enumerate(lines):
    initial_cover = float(line.split("\t")[0])
    final_cover = float(line.split("\t")[2])
    bucket = get_bucket(buckets, initial_cover, step_size * 0.5)
    if aggregated_data.get(bucket) is None:
        aggregated_data[bucket] = [final_cover]
    else:
        aggregated_data[bucket].append(final_cover)

print("\nInitial_cover Final_cover")
for bucket, sums in aggregated_data.items():
    aggregated_data[bucket] = stats.mean(aggregated_data[bucket])
    print(f"{bucket} {aggregated_data[bucket]}")
print("\n")

